---

title: Image Classification Classifiers


keywords: fastai
sidebar: home_sidebar

summary: "Set of Classifiers for Image Classification."
description: "Set of Classifiers for Image Classification."
nb_path: "nbs/01d_classification.modelling.classifiers.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01d_classification.modelling.classifiers.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GeneralClassifier" class="doc_header"><code>class</code> <code>GeneralClassifier</code><a href="https://github.com/benihime91/lightning_cv/tree/master/lightning_cv/classification/modelling/classifiers.py#L23" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GeneralClassifier</code>(<strong><code>num_features</code></strong>:<code>int</code>, <strong><code>num_classes</code></strong>:<code>int</code>, <strong><code>drop_rate</code></strong>:<code>float</code>=<em><code>0.0</code></em>, <strong><code>pool_type</code></strong>=<em><code>'avg'</code></em>, <strong><code>use_conv</code></strong>=<em><code>False</code></em>) :: <code>Module</code></p>
</blockquote>
<p>A classification head w/ configurable global pooling and dropout that is similar to the one created by the timm library</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="4fb0b45a-017b-47cb-991c-81fa3d473358"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#4fb0b45a-017b-47cb-991c-81fa3d473358');

            setTimeout(function() {
                var nbb_cell_id = 8;
                var nbb_unformatted_code = "# export\nclass GeneralClassifier(nn.Module):\n    \"A classification head w/ configurable global pooling and dropout that is similar to the one created by the timm library\"\n\n    @delegates(create_classifier)\n    def __init__(\n        self, num_features: int, num_classes: int, drop_rate: float = 0.0, **kwargs\n    ):\n        super(GeneralClassifier, self).__init__()\n        self.global_pool, self.fc = create_classifier(\n            num_features, num_classes, **kwargs\n        )\n        self.drop_rate = drop_rate\n\n    def forward(self, x):\n        x = self.global_pool(x)\n        if self.drop_rate:\n            x = F.dropout(x, p=float(self.drop_rate), training=self.training)\n        x = self.fc(x)\n        return x\n\n    @classmethod\n    def from_config(cls, cfg: DictConfig):\n        return cls(**cfg)";
                var nbb_formatted_code = "# export\nclass GeneralClassifier(nn.Module):\n    \"A classification head w/ configurable global pooling and dropout that is similar to the one created by the timm library\"\n\n    @delegates(create_classifier)\n    def __init__(\n        self, num_features: int, num_classes: int, drop_rate: float = 0.0, **kwargs\n    ):\n        super(GeneralClassifier, self).__init__()\n        self.global_pool, self.fc = create_classifier(\n            num_features, num_classes, **kwargs\n        )\n        self.drop_rate = drop_rate\n\n    def forward(self, x):\n        x = self.global_pool(x)\n        if self.drop_rate:\n            x = F.dropout(x, p=float(self.drop_rate), training=self.training)\n        x = self.fc(x)\n        return x\n\n    @classmethod\n    def from_config(cls, cfg: DictConfig):\n        return cls(**cfg)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">lightning_cv.config</span> <span class="kn">import</span> <span class="n">get_cfg</span>
<span class="kn">from</span> <span class="nn">lightning_cv.classification.modelling.backbones</span> <span class="kn">import</span> <span class="n">create_cnn_backbone</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">get_cfg</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">BACKBONE</span><span class="o">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="s2">&quot;TimmBackBoneBase&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">BACKBONE</span><span class="o">.</span><span class="n">ARGUMENTS</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;efficientnet_b0&quot;</span><span class="p">,</span> <span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">act_layer</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="fd95c3c0-b576-4dc3-86fe-64e7894cfed6"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#fd95c3c0-b576-4dc3-86fe-64e7894cfed6');

            setTimeout(function() {
                var nbb_cell_id = 9;
                var nbb_unformatted_code = "from lightning_cv.config import get_cfg\nfrom lightning_cv.classification.modelling.backbones import create_cnn_backbone\n\ncfg = get_cfg()\ncfg.MODEL.BACKBONE.NAME = \"TimmBackBoneBase\"\ncfg.MODEL.BACKBONE.ARGUMENTS = dict(\n    model_name=\"efficientnet_b0\", pretrained=True, cut=None, act_layer=None\n)";
                var nbb_formatted_code = "from lightning_cv.config import get_cfg\nfrom lightning_cv.classification.modelling.backbones import create_cnn_backbone\n\ncfg = get_cfg()\ncfg.MODEL.BACKBONE.NAME = \"TimmBackBoneBase\"\ncfg.MODEL.BACKBONE.ARGUMENTS = dict(\n    model_name=\"efficientnet_b0\", pretrained=True, cut=None, act_layer=None\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">backbone</span> <span class="o">=</span> <span class="n">create_cnn_backbone</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">num_features_model</span><span class="p">(</span><span class="n">backbone</span><span class="p">)</span>

<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">ARGUMENTS</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">num_features</span><span class="o">=</span><span class="n">features</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">drop_rate</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">pool_type</span><span class="o">=</span><span class="s2">&quot;avg&quot;</span>
<span class="p">)</span>
<span class="n">tst</span> <span class="o">=</span> <span class="n">GeneralClassifier</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tst</span><span class="p">)</span>

<span class="n">mods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tst</span><span class="o">.</span><span class="n">children</span><span class="p">())</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mods</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>GeneralClassifier(
  (global_pool): SelectAdaptivePool2d (pool_type=avg, flatten=True)
  (fc): Linear(in_features=1280, out_features=1000, bias=True)
)
</pre>
</div>
</div>

<div class="output_area">




<div id="1417dee0-1fc7-4daa-9828-76ba5f5a3791"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#1417dee0-1fc7-4daa-9828-76ba5f5a3791');

            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "backbone = create_cnn_backbone(cfg)\nfeatures = num_features_model(backbone)\n\ncfg.MODEL.CLASSIFIER.ARGUMENTS = dict(\n    num_features=features, num_classes=1000, drop_rate=0.25, pool_type=\"avg\"\n)\ntst = GeneralClassifier.from_config(cfg.MODEL.CLASSIFIER.ARGUMENTS)\n\nprint(tst)\n\nmods = list(tst.children())\ntest_eq(len(mods), 2)";
                var nbb_formatted_code = "backbone = create_cnn_backbone(cfg)\nfeatures = num_features_model(backbone)\n\ncfg.MODEL.CLASSIFIER.ARGUMENTS = dict(\n    num_features=features, num_classes=1000, drop_rate=0.25, pool_type=\"avg\"\n)\ntst = GeneralClassifier.from_config(cfg.MODEL.CLASSIFIER.ARGUMENTS)\n\nprint(tst)\n\nmods = list(tst.children())\ntest_eq(len(mods), 2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">backbone</span> <span class="o">=</span> <span class="n">create_cnn_backbone</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">num_features_model</span><span class="p">(</span><span class="n">backbone</span><span class="p">)</span>

<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">ARGUMENTS</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">num_features</span><span class="o">=</span><span class="n">features</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">drop_rate</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">pool_type</span><span class="o">=</span><span class="s2">&quot;catavgmax&quot;</span>
<span class="p">)</span>
<span class="n">tst</span> <span class="o">=</span> <span class="n">GeneralClassifier</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tst</span><span class="p">)</span>

<span class="n">mods</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tst</span><span class="o">.</span><span class="n">children</span><span class="p">())</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mods</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>GeneralClassifier(
  (global_pool): SelectAdaptivePool2d (pool_type=catavgmax, flatten=True)
  (fc): Linear(in_features=2560, out_features=1000, bias=True)
)
</pre>
</div>
</div>

<div class="output_area">




<div id="75dde21e-10ce-482d-9fea-cc48f312cde2"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#75dde21e-10ce-482d-9fea-cc48f312cde2');

            setTimeout(function() {
                var nbb_cell_id = 11;
                var nbb_unformatted_code = "backbone = create_cnn_backbone(cfg)\nfeatures = num_features_model(backbone)\n\ncfg.MODEL.CLASSIFIER.ARGUMENTS = dict(\n    num_features=features, num_classes=1000, drop_rate=0.25, pool_type=\"catavgmax\"\n)\ntst = GeneralClassifier.from_config(cfg.MODEL.CLASSIFIER.ARGUMENTS)\n\nprint(tst)\n\nmods = list(tst.children())\ntest_eq(len(mods), 2)";
                var nbb_formatted_code = "backbone = create_cnn_backbone(cfg)\nfeatures = num_features_model(backbone)\n\ncfg.MODEL.CLASSIFIER.ARGUMENTS = dict(\n    num_features=features, num_classes=1000, drop_rate=0.25, pool_type=\"catavgmax\"\n)\ntst = GeneralClassifier.from_config(cfg.MODEL.CLASSIFIER.ARGUMENTS)\n\nprint(tst)\n\nmods = list(tst.children())\ntest_eq(len(mods), 2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FastaiClassifier" class="doc_header"><code>class</code> <code>FastaiClassifier</code><a href="https://github.com/benihime91/lightning_cv/tree/master/lightning_cv/classification/modelling/classifiers.py#L48" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FastaiClassifier</code>(<strong><code>num_features</code></strong>:<code>int</code>, <strong><code>num_classes</code></strong>:<code>int</code>, <strong><code>lin_ftrs</code></strong>:<code>Optional</code>[<code>List</code>[<code>T</code>]]=<em><code>None</code></em>, <strong><code>ps</code></strong>:<code>float</code>=<em><code>0.5</code></em>, <strong><code>concat_pool</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>first_bn</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>bn_final</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>lin_first</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>act_layer</code></strong>:<code>str</code>=<em><code>'ReLU'</code></em>) :: <code>Sequential</code></p>
</blockquote>
<p>A classification head same as head generated from : <a href="https://github.com/fastai/fastai/blob/master/fastai/vision/learner.py#L76">https://github.com/fastai/fastai/blob/master/fastai/vision/learner.py#L76</a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="84702688-e32e-4339-9abf-18422743817e"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#84702688-e32e-4339-9abf-18422743817e');

            setTimeout(function() {
                var nbb_cell_id = 12;
                var nbb_unformatted_code = "# export\nclass FastaiClassifier(nn.Sequential):\n    \"A classification head same as head generated from : https://github.com/fastai/fastai/blob/master/fastai/vision/learner.py#L76\"\n\n    def __init__(\n        self,\n        num_features: int,\n        num_classes: int,\n        lin_ftrs: Optional[List] = None,\n        ps: float = 0.5,\n        concat_pool: bool = True,\n        first_bn: bool = True,\n        bn_final: bool = False,\n        lin_first: bool = False,\n        act_layer: str = \"ReLU\",\n    ):\n\n        # if using concat_pool then mult the number of features\n        if concat_pool:\n            num_features *= 2\n\n        # features of the linear layers\n        lin_ftrs = (\n            [num_features, 512, num_classes]\n            if lin_ftrs is None\n            else [num_features] + lin_ftrs + [num_classes]\n        )\n\n        bns = [first_bn] + [True] * len(lin_ftrs[1:])\n\n        ps = L(ps)\n\n        if len(ps) == 1:\n            ps = [ps[0] / 2] * (len(lin_ftrs) - 2) + ps\n\n        act_layer = [ACTIVATION_REGISTERY.get(act_layer)(inplace=True)]\n        actns = act_layer * (len(lin_ftrs) - 2) + [None]\n        pool = AdaptiveConcatPool2d() if concat_pool else nn.AdaptiveAvgPool2d(1)\n\n        layers = [pool, nn.Flatten()]\n\n        if lin_first:\n            layers.append(nn.Dropout(ps.pop(0)))\n\n        for ni, no, bn, p, actn in zip(lin_ftrs[:-1], lin_ftrs[1:], bns, ps, actns):\n            layers += LinBnDrop(ni, no, bn=bn, p=p, act=actn, lin_first=lin_first)\n\n        if lin_first:\n            layers.append(nn.Linear(lin_ftrs[-2], num_classes))\n\n        if bn_final:\n            layers.append(nn.BatchNorm1d(lin_ftrs[-1], momentum=0.01))\n\n        super(FastaiClassifier, self).__init__(*layers)\n\n    @classmethod\n    def from_config(cls, cfg: DictConfig):\n        return cls(**cfg)";
                var nbb_formatted_code = "# export\nclass FastaiClassifier(nn.Sequential):\n    \"A classification head same as head generated from : https://github.com/fastai/fastai/blob/master/fastai/vision/learner.py#L76\"\n\n    def __init__(\n        self,\n        num_features: int,\n        num_classes: int,\n        lin_ftrs: Optional[List] = None,\n        ps: float = 0.5,\n        concat_pool: bool = True,\n        first_bn: bool = True,\n        bn_final: bool = False,\n        lin_first: bool = False,\n        act_layer: str = \"ReLU\",\n    ):\n\n        # if using concat_pool then mult the number of features\n        if concat_pool:\n            num_features *= 2\n\n        # features of the linear layers\n        lin_ftrs = (\n            [num_features, 512, num_classes]\n            if lin_ftrs is None\n            else [num_features] + lin_ftrs + [num_classes]\n        )\n\n        bns = [first_bn] + [True] * len(lin_ftrs[1:])\n\n        ps = L(ps)\n\n        if len(ps) == 1:\n            ps = [ps[0] / 2] * (len(lin_ftrs) - 2) + ps\n\n        act_layer = [ACTIVATION_REGISTERY.get(act_layer)(inplace=True)]\n        actns = act_layer * (len(lin_ftrs) - 2) + [None]\n        pool = AdaptiveConcatPool2d() if concat_pool else nn.AdaptiveAvgPool2d(1)\n\n        layers = [pool, nn.Flatten()]\n\n        if lin_first:\n            layers.append(nn.Dropout(ps.pop(0)))\n\n        for ni, no, bn, p, actn in zip(lin_ftrs[:-1], lin_ftrs[1:], bns, ps, actns):\n            layers += LinBnDrop(ni, no, bn=bn, p=p, act=actn, lin_first=lin_first)\n\n        if lin_first:\n            layers.append(nn.Linear(lin_ftrs[-2], num_classes))\n\n        if bn_final:\n            layers.append(nn.BatchNorm1d(lin_ftrs[-1], momentum=0.01))\n\n        super(FastaiClassifier, self).__init__(*layers)\n\n    @classmethod\n    def from_config(cls, cfg: DictConfig):\n        return cls(**cfg)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The head begins with with a <a href="/lightning_cv/core.layers.html#AdaptiveConcatPool2d"><code>AdaptiveConcatPool2d</code></a> (adapted from fastai) if <code>concat_pool=True</code> otherwise, it uses traditional average pooling. Then it uses a Flatten layer before going on blocks of BatchNorm, Dropout and Linear layers <code>(if lin_first=True, those are Linear, BatchNorm, Dropout)</code>.</p>
<p>Those blocks start at <code>num_features</code>, then every element of <code>lin_ftrs</code> (defaults to [512]) and end at <code>num_classes</code>. <code>ps</code> is a list of probabilities used for the dropouts (if you only pass 1, it will use half the value then that value as many times as necessary).</p>
<p>If <code>first_bn=True</code>, a BatchNorm added just after the pooling operations. If <code>bn_final=True</code>, a final BatchNorm layer is added.</p>
<p>Activation functions are added after every blocks of BatchNorm, Dropout and Linear layers. The function is inferred from <a href="/lightning_cv/core.layers.html#ACTIVATION_REGISTERY"><code>ACTIVATION_REGISTERY</code></a> using <code>act_layer</code> (defaults to ReLU).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span> <span class="o">=</span> <span class="n">FastaiClassifier</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">tst</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>FastaiClassifier(
  (0): AdaptiveConcatPool2d(
    (ap): AdaptiveAvgPool2d(output_size=1)
    (mp): AdaptiveMaxPool2d(output_size=1)
  )
  (1): Flatten(start_dim=1, end_dim=-1)
  (2): BatchNorm1d(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (3): Dropout(p=0.25, inplace=False)
  (4): Linear(in_features=2560, out_features=512, bias=False)
  (5): ReLU(inplace=True)
  (6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (7): Dropout(p=0.5, inplace=False)
  (8): Linear(in_features=512, out_features=10, bias=False)
)</pre>
</div>

</div>

<div class="output_area">




<div id="7b124cac-f97e-4013-9270-c7f76510b0db"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#7b124cac-f97e-4013-9270-c7f76510b0db');

            setTimeout(function() {
                var nbb_cell_id = 13;
                var nbb_unformatted_code = "tst = FastaiClassifier(features, 10)\ntst";
                var nbb_formatted_code = "tst = FastaiClassifier(features, 10)\ntst";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tst</span> <span class="o">=</span> <span class="n">FastaiClassifier</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">act_layer</span><span class="o">=</span><span class="s2">&quot;Mish&quot;</span><span class="p">,</span> <span class="n">lin_ftrs</span><span class="o">=</span><span class="p">[</span><span class="mi">512</span><span class="p">,</span> <span class="mi">155</span><span class="p">])</span>
<span class="n">tst</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>FastaiClassifier(
  (0): AdaptiveConcatPool2d(
    (ap): AdaptiveAvgPool2d(output_size=1)
    (mp): AdaptiveMaxPool2d(output_size=1)
  )
  (1): Flatten(start_dim=1, end_dim=-1)
  (2): BatchNorm1d(2560, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (3): Dropout(p=0.25, inplace=False)
  (4): Linear(in_features=2560, out_features=512, bias=False)
  (5): Mish()
  (6): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (7): Dropout(p=0.25, inplace=False)
  (8): Linear(in_features=512, out_features=155, bias=False)
  (9): Mish()
  (10): BatchNorm1d(155, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (11): Dropout(p=0.5, inplace=False)
  (12): Linear(in_features=155, out_features=10, bias=False)
)</pre>
</div>

</div>

<div class="output_area">




<div id="4b877f8b-9bd6-40e6-8f02-974f926ebed2"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#4b877f8b-9bd6-40e6-8f02-974f926ebed2');

            setTimeout(function() {
                var nbb_cell_id = 15;
                var nbb_unformatted_code = "tst = FastaiClassifier(features, 10, act_layer=\"Mish\", lin_ftrs=[512, 155])\ntst";
                var nbb_formatted_code = "tst = FastaiClassifier(features, 10, act_layer=\"Mish\", lin_ftrs=[512, 155])\ntst";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Classifier-Registery">Classifier Registery<a class="anchor-link" href="#Classifier-Registery"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="803fd16c-5b25-42ab-9844-a9040bbc3650"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#803fd16c-5b25-42ab-9844-a9040bbc3650');

            setTimeout(function() {
                var nbb_cell_id = 21;
                var nbb_unformatted_code = "# export\nCLASSIFICATION_CLASSIFIER_REGISTRY = Registry(\n    \"Classification Classifiers\"\n)\n\nCLASSIFICATION_CLASSIFIER_REGISTRY.__doc__ = \"Registry of Classifiers for Image Classification\"\nCLASSIFICATION_CLASSIFIER_REGISTRY.register(FastaiClassifier)\nCLASSIFICATION_CLASSIFIER_REGISTRY.register(GeneralClassifier)";
                var nbb_formatted_code = "# export\nCLASSIFICATION_CLASSIFIER_REGISTRY = Registry(\"Classification Classifiers\")\n\nCLASSIFICATION_CLASSIFIER_REGISTRY.__doc__ = (\n    \"Registry of Classifiers for Image Classification\"\n)\nCLASSIFICATION_CLASSIFIER_REGISTRY.register(FastaiClassifier)\nCLASSIFICATION_CLASSIFIER_REGISTRY.register(GeneralClassifier)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Classification Classifiers" class="doc_header"><code>Classification Classifiers</code><a href="" class="source_link" style="float:right">[source]</a></h4><p>Registry of Classifiers for Image Classification</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CLASSIFICATION_CLASSIFIER_REGISTRY</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary data-open="Hide Output" data-close="Show Output"></summary>
        <summary></summary>
        
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Registry of Classification Classifiers:
╒═══════════════════╤══════════════════════════════════════╕
│ Names             │ Objects                              │
╞═══════════════════╪══════════════════════════════════════╡
│ FastaiClassifier  │ &lt;class &#39;__main__.FastaiClassifier&#39;&gt;  │
├───────────────────┼──────────────────────────────────────┤
│ GeneralClassifier │ &lt;class &#39;__main__.GeneralClassifier&#39;&gt; │
╘═══════════════════╧══════════════════════════════════════╛</pre>
</div>

</div>

<div class="output_area">




<div id="bf81c202-2d75-4604-8b60-9b46ca00fa30"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#bf81c202-2d75-4604-8b60-9b46ca00fa30');

            setTimeout(function() {
                var nbb_cell_id = 23;
                var nbb_unformatted_code = "# collapse-output\nCLASSIFICATION_CLASSIFIER_REGISTRY";
                var nbb_formatted_code = "# collapse-output\nCLASSIFICATION_CLASSIFIER_REGISTRY";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

    </details>
</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_classifier_head" class="doc_header"><code>create_classifier_head</code><a href="https://github.com/benihime91/lightning_cv/tree/master/lightning_cv/classification/modelling/classifiers.py#L116" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_classifier_head</code>(<strong><code>cfg</code></strong>:<code>DictConfig</code>)</p>
</blockquote>
<p>instante an obj from <code>CNN_CLASSIFIER_REGISTRY</code> registery using lightning_cv.config</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="330440e8-6ffe-4537-9d81-0e712a171373"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#330440e8-6ffe-4537-9d81-0e712a171373');

            setTimeout(function() {
                var nbb_cell_id = 24;
                var nbb_unformatted_code = "# export\ndef create_classifier_head(cfg: DictConfig):\n    \"instante an obj from `CNN_CLASSIFIER_REGISTRY` registery using lightning_cv.config\"\n    classifier_cls = CLASSIFICATION_CLASSIFIER_REGISTRY.get(cfg.MODEL.CLASSIFIER.NAME)\n    classifier = classifier_cls.from_config(cfg.MODEL.CLASSIFIER.ARGUMENTS)\n    return classifier";
                var nbb_formatted_code = "# export\ndef create_classifier_head(cfg: DictConfig):\n    \"instante an obj from `CNN_CLASSIFIER_REGISTRY` registery using lightning_cv.config\"\n    classifier_cls = CLASSIFICATION_CLASSIFIER_REGISTRY.get(cfg.MODEL.CLASSIFIER.NAME)\n    classifier = classifier_cls.from_config(cfg.MODEL.CLASSIFIER.ARGUMENTS)\n    return classifier";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create a <code>classification_head</code> from <code>lightning_cv.config</code> -</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">lightning_cv.config</span> <span class="kn">import</span> <span class="n">get_cfg</span>
<span class="kn">from</span> <span class="nn">omegaconf</span> <span class="kn">import</span> <span class="n">OmegaConf</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">get_cfg</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="s2">&quot;GeneralClassifier&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">OmegaConf</span><span class="o">.</span><span class="n">to_yaml</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>BACKBONE:
  NAME: TimmBackBoneBase
  ARGUMENTS:
    model_name: efficientnet_b0
    cut: null
    act_layer: null
    pretrained: true
    drop_path_rate: 0.3
CLASSIFIER:
  NAME: GeneralClassifier
  ARGUMENTS:
    num_features: ???
    num_classes: ???
    drop_rate: 0.25
    pool_type: avg
    use_conv: false

</pre>
</div>
</div>

<div class="output_area">




<div id="dc4f7a51-b0c2-4c9a-a350-b054f8cc7b4a"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#dc4f7a51-b0c2-4c9a-a350-b054f8cc7b4a');

            setTimeout(function() {
                var nbb_cell_id = 29;
                var nbb_unformatted_code = "from lightning_cv.config import get_cfg\nfrom omegaconf import OmegaConf\n\ncfg = get_cfg()\ncfg.MODEL.CLASSIFIER.NAME = \"GeneralClassifier\"\nprint(OmegaConf.to_yaml(cfg.MODEL))";
                var nbb_formatted_code = "from lightning_cv.config import get_cfg\nfrom omegaconf import OmegaConf\n\ncfg = get_cfg()\ncfg.MODEL.CLASSIFIER.NAME = \"GeneralClassifier\"\nprint(OmegaConf.to_yaml(cfg.MODEL))";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Building your model from config -</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">lightning_cv.classification.modelling.backbones</span> <span class="kn">import</span> <span class="n">create_cnn_backbone</span>

<span class="n">backbone</span> <span class="o">=</span> <span class="n">create_cnn_backbone</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">num_features_model</span><span class="p">(</span><span class="n">backbone</span><span class="p">)</span>

<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="s2">&quot;GeneralClassifier&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="o">.</span><span class="n">num_features</span> <span class="o">=</span> <span class="n">features</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">ARGUMENTS</span><span class="o">.</span><span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">create_classifier_head</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>GeneralClassifier(
  (global_pool): SelectAdaptivePool2d (pool_type=avg, flatten=True)
  (fc): Linear(in_features=1280, out_features=10, bias=True)
)
</pre>
</div>
</div>

<div class="output_area">




<div id="13ceea54-f993-49c6-8dca-bc282a04b24a"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#13ceea54-f993-49c6-8dca-bc282a04b24a');

            setTimeout(function() {
                var nbb_cell_id = 30;
                var nbb_unformatted_code = "from lightning_cv.classification.modelling.backbones import create_cnn_backbone\n\nbackbone = create_cnn_backbone(cfg)\nfeatures = num_features_model(backbone)\n\ncfg.MODEL.CLASSIFIER.NAME = \"GeneralClassifier\"\ncfg.MODEL.CLASSIFIER.ARGUMENTS.num_features = features\ncfg.MODEL.CLASSIFIER.ARGUMENTS.num_classes = 10\n\nclassifier = create_classifier_head(cfg)\nprint(classifier)";
                var nbb_formatted_code = "from lightning_cv.classification.modelling.backbones import create_cnn_backbone\n\nbackbone = create_cnn_backbone(cfg)\nfeatures = num_features_model(backbone)\n\ncfg.MODEL.CLASSIFIER.NAME = \"GeneralClassifier\"\ncfg.MODEL.CLASSIFIER.ARGUMENTS.num_features = features\ncfg.MODEL.CLASSIFIER.ARGUMENTS.num_classes = 10\n\nclassifier = create_classifier_head(cfg)\nprint(classifier)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="n">tst</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">backbone</span><span class="p">,</span> <span class="n">classifier</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">tst</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="7f913123-c4e4-4f3c-bbba-a16982c89b22"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#7f913123-c4e4-4f3c-bbba-a16982c89b22');

            setTimeout(function() {
                var nbb_cell_id = 31;
                var nbb_unformatted_code = "inputs = torch.randn(1, 3, 255, 255)\ntst = nn.Sequential(backbone, classifier)\noutput = tst(inputs)\ntest_eq(output.shape, [1, 10])";
                var nbb_formatted_code = "inputs = torch.randn(1, 3, 255, 255)\ntst = nn.Sequential(backbone, classifier)\noutput = tst(inputs)\ntest_eq(output.shape, [1, 10])";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can also create your custom classifier head like so -</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@CLASSIFICATION_CLASSIFIER_REGISTRY</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">MyCustomClassifier</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyCustomClassifier</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fc1</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">cfg</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="4a9648e2-63d7-4c4b-b753-a61ede5ea746"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#4a9648e2-63d7-4c4b-b753-a61ede5ea746');

            setTimeout(function() {
                var nbb_cell_id = 32;
                var nbb_unformatted_code = "@CLASSIFICATION_CLASSIFIER_REGISTRY.register()\nclass MyCustomClassifier(nn.Sequential):\n    def __init__(self, num_features: int, num_classes: int):\n        fc1 = nn.Linear(num_features, num_classes, bias=False)\n        super(MyCustomClassifier, self).__init__(fc1)\n\n    @classmethod\n    def from_config(cls, cfg: DictConfig):\n        return cls(**cfg)";
                var nbb_formatted_code = "@CLASSIFICATION_CLASSIFIER_REGISTRY.register()\nclass MyCustomClassifier(nn.Sequential):\n    def __init__(self, num_features: int, num_classes: int):\n        fc1 = nn.Linear(num_features, num_classes, bias=False)\n        super(MyCustomClassifier, self).__init__(fc1)\n\n    @classmethod\n    def from_config(cls, cfg: DictConfig):\n        return cls(**cfg)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include important.html content='You custom classifier must have a <code>.from_config</code> classmethod with takes in a Omegaconf config and instantiates the class.' %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">NAME</span> <span class="o">=</span> <span class="s2">&quot;MyCustomClassifier&quot;</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">CLASSIFIER</span><span class="o">.</span><span class="n">ARGUMENTS</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">num_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">create_classifier_head</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>MyCustomClassifier(
  (0): Linear(in_features=5, out_features=10, bias=False)
)</pre>
</div>

</div>

<div class="output_area">




<div id="d0a4dd35-ec9d-494b-8e21-7a9e996baf86"></div>
<div class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#d0a4dd35-ec9d-494b-8e21-7a9e996baf86');

            setTimeout(function() {
                var nbb_cell_id = 33;
                var nbb_unformatted_code = "cfg.MODEL.CLASSIFIER.NAME = \"MyCustomClassifier\"\ncfg.MODEL.CLASSIFIER.ARGUMENTS = dict(num_features=5, num_classes=10)\ncreate_classifier_head(cfg)";
                var nbb_formatted_code = "cfg.MODEL.CLASSIFIER.NAME = \"MyCustomClassifier\"\ncfg.MODEL.CLASSIFIER.ARGUMENTS = dict(num_features=5, num_classes=10)\ncreate_classifier_head(cfg)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

